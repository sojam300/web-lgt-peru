<div *ngIf="isSubmitting" class="spinner-overlay">
  <mat-spinner color="primary"></mat-spinner>
</div>
<app-sidenav>
  <div class="container-fluid">
    
  <div class="d-flex justify-content-between pt-5">
    <div>
      <span class="fs-1 fw-light fst-italic text-secondary">Planilla Movilidad</span>
    </div>
    <div class="">
      <button mat-flat-button [routerLink]="['/planilla_movilidad_form']">Crear</button>

    </div>
  </div>



  <div class="row g-3 my-3">
    <div class="col-12 col-sm-6 col-md-4">
      <mat-form-field class="input">
        <mat-label>Fecha Inicio</mat-label>
        <input matInput [matDatepicker]="pickerFechaDesde" [(ngModel)]="queryParams.fecha_desde">
        <mat-hint>DD/MM/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="pickerFechaDesde"></mat-datepicker-toggle>
        <mat-datepicker #pickerFechaDesde></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-12 col-sm-6 col-md-4">
      <mat-form-field class="input">
        <mat-label>Fecha Fin</mat-label>
        <input matInput [matDatepicker]="pickerFechaHasta" [(ngModel)]="queryParams.fecha_hasta">
        <mat-hint>DD/MM/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="pickerFechaHasta"></mat-datepicker-toggle>
        <mat-datepicker #pickerFechaHasta></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-12 col-sm-6 col-md-4">
      <mat-form-field class="input">
        <mat-label>Estado</mat-label>
        <mat-select matInput [(ngModel)]="queryParams.id_estado">
          @for (estado of estadosRequemiento; track estado) {
          <mat-option [value]="estado.id">{{estado.nombre}}</mat-option>
          }
        </mat-select>
      </mat-form-field>

    </div>
    <div class="col-12 col-sm-6 col-md-4">
      <mat-form-field class="input">
        <mat-label>Texto</mat-label>
        <input matInput placeholder="Ex. Persona, ciudad" [(ngModel)]="queryParams.texto">
      </mat-form-field>
    </div>
    <div class="col-6 col-sm-6 col-md-4 ">
      <mat-form-field class="input">
        <mat-label>Estado</mat-label>
        <mat-select matInput [(ngModel)]="queryParams.id_estado">
          @for (estado of estadosRequemiento; track estado) {
          <mat-option [value]="estado.id">{{estado.nombre}}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    <div class="col-auto d-flex flex-fill justify-content-end">
      <!-- <button mat-raised-button> <mat-icon>search</mat-icon> </button> -->

      <button mat-icon-button color="primary" aria-label="Buscar" class="mat-icon-button-large mat-icon-button-center">
        <!-- <mat-icon class="mat-icon-large">search</mat-icon> -->
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </div>
  </div>

  <div class="pb-5">
    <section class="example-container  table-responsive">
      <table mat-table [dataSource]="planillasMovilidad">
        <!-- <ng-container matColumnDef="index">
        <th mat-header-cell *matHeaderCellDef> index </th>
        <td mat-cell *matCellDef="let index = index"> {{index+1}} </td>
      </ng-container> -->

        <ng-container matColumnDef="codigo">
          <th mat-header-cell *matHeaderCellDef> Codigo </th>
          <td mat-cell *matCellDef="let element">
            <i class="fa-solid fa-circle text-secondary mx-1"></i>
            {{element.codigo}}
          </td>
        </ng-container>

        <ng-container matColumnDef="usuario">
          <th mat-header-cell *matHeaderCellDef> Usuario </th>
          <td mat-cell *matCellDef="let element"> {{element.usuario.nombres}} </td>
        </ng-container>

        <ng-container matColumnDef="proveedor">
          <th mat-header-cell *matHeaderCellDef> Proveedor </th>
          <td mat-cell *matCellDef="let element"> {{element.proveedor.razon_social}} </td>
        </ng-container>

        <ng-container matColumnDef="fecha emicion">
          <th mat-header-cell *matHeaderCellDef> Fecha Emici√≥n </th>
          <td mat-cell *matCellDef="let element"> {{formatearFecha(element.fecha_emicion)}}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </section>
  </div>

  </div>
</app-sidenav>